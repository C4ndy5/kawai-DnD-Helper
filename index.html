<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
        <script
            src="https://code.jquery.com/jquery-3.6.0.min.js"
            integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
            crossorigin="anonymous">
        </script>
        <link rel="stylesheet" href="/kawai-DnD-Helper/style.css">

        <title>!!!AWESOME TRG!!!</title>
    </head>
    <body>
        <header>
            
        </header>

        <div class="main-menu">
            <div class="weapon weapon-menu-1">
                <div class="menu fir-menu-form">
                    <form id="weapon-1" class="weapon">
                        <input class="sett-inp" type="number" name="damage" placeholder="Кол-во костей урона: ">
                        <input class="sett-inp" type="number" name="accuracy" placeholder="Точность: ">
                        <input class="sett-inp" type="number" name="shot-count" placeholder="Кол-во выстрелов: ">
                        <input class="sett-inp" type="text" name="reliability" placeholder="Надежность: ">
                        <input class="sett-inp" id="weapon-1-btn" type="button" name="shot" value="Стрелять!!!">
                    </form>
                </div>

                <div class="menu sec-menu-result">
                    
                </div>
            </div>
            
        </div>

        <footer>
            <script>
                function getRandomInRange(min, max) {
                    return Math.floor(Math.random() * (max - min + 1)) + min;
                }
                
                $('#weapon-1-btn').on('click', function (e) {
                    $('.sec-menu-result').html('');

                    var that = $('#weapon-1');
                    var data_read = that.serializeArray();
                    var data = {};
                    var result = [];
                    var hit;
                    var hit_with_acc;
                    var wound;
                    var count = 0;
                    var c=0;


                    
                    $.each(data_read,function(){
                        data[this.name] = this.value;
                    });

                    var shout_count = +data['shot-count'];
                    var damage = +data['damage'];
                    var accuracy = +data['accuracy'];
                    var reliability;

                    if(data['reliability'] == 'vr'){
                        reliability = 4;
                    }else if(data['reliability'] == 'st'){
                        reliability = 5;
                    }else{
                        reliability = 8;
                    }

                    while (count < shout_count){
                        hit = getRandomInRange(1, 10);
                        hit_with_acc = hit  + accuracy; 

                        while (c < damage)
                        {
                            wound += getRandomInRange(1, 6);
                        }

                        c = 0;

                        if (shout_count > 3 && hit == 1 && getRandomInRange(1, 10) < reliability){
                            $('.sec-menu-result').append($('<div>', {
                                'text': "Wedge on " + getRandomInRange(1, 6) + " rounds!!!"
                            }));
                            break;
                        }

                        result.push("hit: " + hit_with_acc + " -- " + "wound: " + wound);
                        count ++;
                    }
                    count = 1;
                    $.each(result,function(){

                        $('.sec-menu-result').append($('<div>', {
                            'text': count + " " + this
                        }));
                        count ++;
                    });
                })

            </script>
            
        </footer>
    </body>
<html>
